import{X as H,r as n,G as V,j as e,x as j}from"./app-CJp31ENB.js";import{I as X}from"./InputError-BBPw1s1I.js";import{I as q}from"./InputLabel-Dm6wbQ4T.js";import{M as D}from"./Modal-ByFqIGU2.js";import{T as J}from"./TextInput-ktYZ2JZb.js";import{A as K,i as Q}from"./AuthenticatedLayout-jhPrSIak.js";import{r as i}from"./index-B0T46xJU.js";import{R as b}from"./index-BablHmMy.js";import{u as Y}from"./index-DFJCaOBI.js";import"./transition-DwIFESPn.js";import"./Dropdown-ClCrV-pf.js";import"./index-BarBPuyi.js";import"./index-BbIT8xPU.js";function pe({auth:x,albums:h}){const{role:S,permissions:E}=H().props.auth,k=["SN","Album Name","Count",""],[M,r]=n.useState(!1),[T,N]=n.useState(""),[d,g]=n.useState(""),[u,v]=n.useState(""),[I,y]=n.useState(!1),{data:l,setData:c,post:w,processing:_,errors:L,reset:f,delete:R}=V({name:"",attachments:[]}),A=(s,t=0)=>{if(t!==0&&v(t),s==="add")N("Add New"),g("_add");else if(s==="edit"){const a=h.filter(o=>o.id===t);c({...a[0],attachments:[]}),N("Edit"),g("_edit")}r(!0)},C=()=>{r(!1),f()},z=s=>{s.preventDefault(),d==="_add"?w(route("admin.album.store"),{preserveScroll:!0,onSuccess:()=>{f(),r(!1)}}):d==="_edit"&&w(route("admin.album.update",u),{onSuccess:()=>{f(),r(!1)}})},{getRootProps:W,getInputProps:F,isDragActive:U}=Y({accept:{"image/*":[]},onDrop:s=>{c("attachments",[...l==null?void 0:l.attachments,...s.map(t=>Object.assign(t,{preview:URL.createObjectURL(t)}))])}}),O=s=>{const t=l==null?void 0:l.attachments.filter((a,o)=>a.preview!==s.preview);c("attachments",t)},P=l==null?void 0:l.attachments.map((s,t)=>e.jsxs("div",{className:"border border-gray-300 rounded relative w-36 h-36 p-1",children:[e.jsx("div",{className:"absolute -top-2 -right-2 bg-red-500 rounded-full text-white p-1 cursor-pointer",children:e.jsx(b,{size:16,onClick:()=>{O(s)}})}),e.jsx("img",{src:s.preview,className:"w-full h-full object-cover rounded"})]},t)),B=s=>{v(s),y(!0)},m=()=>{y(!1)},G=()=>{u&&R(route("admin.album.delete",u),{onSuccess:()=>{m()}})};return e.jsxs(K,{user:x==null?void 0:x.user,children:[e.jsxs("div",{className:"content py-4 font-poppins",children:[e.jsxs("div",{className:"content-header px-6 flex justify-between items-center",children:[e.jsxs("div",{className:"left",children:[e.jsx("h1",{className:"font-semibold text-gray-800 text-3xl",children:"Albums"}),e.jsx("div",{className:"pt-2",children:e.jsxs("ul",{className:"flex gap-1 text-gray-600 text-sm",children:[e.jsx("li",{children:e.jsx(j,{href:route("dashboard"),children:"Dashboard"})}),e.jsx("li",{children:"/"}),e.jsx("li",{children:e.jsx(j,{href:route("admin.album.index"),children:"Albums"})})]})})]}),e.jsx("div",{className:"right",children:e.jsx("button",{className:"bg-[#f5cd06] shadow-lg text-[#0f0f0f] px-5 py-3 rounded-md font-semibold text-lg font-poppins",onClick:()=>{A("add")},children:"Add New"})})]}),e.jsx("div",{className:"page-content pt-8",children:e.jsx(i.Card,{className:"h-full w-full overflow-scroll rounded-none font-poppins",children:e.jsxs("table",{className:"w-full min-w-max table-auto text-left font-poppins",children:[e.jsx("thead",{children:e.jsx("tr",{children:k.map(s=>e.jsx("th",{className:"border-b border-blue-gray-100 bg-blue-gray-50 p-4",children:e.jsx(i.Typography,{className:"font-semibold text-lg leading-none opacity-70 font-poppins",children:s})},s))})}),e.jsx("tbody",{children:h.map(({id:s,name:t,attachment_count:a},o)=>{const p=o===h.length-1?"p-4":"p-4 border-b border-blue-gray-50";return e.jsxs("tr",{children:[e.jsx("td",{className:p,children:e.jsx(i.Typography,{className:"font-medium font-poppins",children:o+1})}),e.jsx("td",{className:p,children:e.jsx(i.Typography,{className:"font-medium font-poppins",children:t})}),e.jsx("td",{className:p,children:e.jsx(i.Typography,{className:"font-medium font-poppins",children:a})}),e.jsx("td",{className:p,children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"px-0 text-sm font-medium font-poppins",onClick:()=>{A("edit",s)},children:"Edit"}),e.jsx(j,{href:route("admin.album.view",s),className:"px-0 text-sm font-medium font-poppins",children:"View"}),Q(E,["delete_albums"],S)&&e.jsx("button",{className:"text-red-500 px-0 text-sm font-medium font-poppins",onClick:()=>{B(s)},children:"Delete"})]})})]},o)})})]})})})]}),e.jsx(D,{show:M,onClose:C,maxWidth:"2xl",children:e.jsxs("div",{className:"delete-modal px-6 py-8 relative font-poppins",children:[e.jsxs("h1",{className:"font-bold text-2xl font-poppins",children:[T," Album"]}),e.jsx("div",{className:"absolute -top-8 -right-8 text-white cursor-pointer",children:e.jsx(b,{strokeWidth:1.5,size:38,onClick:C})}),e.jsx("div",{className:"modal-content pt-6",children:e.jsxs("form",{onSubmit:z,children:[e.jsxs("div",{className:"form-item mb-6",children:[e.jsx(q,{value:"Album Name",className:"mb-1 font-poppins font-semibold"}),e.jsx(J,{id:"title",type:"text",name:"name",className:"w-full rounded-md font-poppins",placeholder:"Album Name...",onChange:s=>c("name",s.target.value),value:l.name}),e.jsx(X,{message:L.name,className:"mt-2"})]}),d==="_add"&&e.jsxs("div",{className:"form-item mb-6",children:[e.jsxs("div",{...W(),className:"flex items-center justify-center border-dotted border-2 py-7 rounded-md cursor-pointer",children:[e.jsx("input",{...F()}),U?e.jsx("p",{children:"Drop the files here ..."}):e.jsx("p",{className:"text-gray-500 text-sm font-poppins",children:"Drag 'n' drop some files here, or click to select files"})]}),e.jsx("aside",{className:"flex flex-wrap mt-6 gap-3",children:P})]}),e.jsx("input",{type:"hidden",name:"type",value:d}),e.jsx("div",{className:"font-item mb-4 text-right",children:e.jsx("button",{className:"bg-blue-500 text-white px-6 py-3 font-poppins rounded-sm font-bold",disabled:_,children:"Submit"})})]})})]})}),e.jsx(D,{show:I,onClose:m,maxWidth:"xl",children:e.jsxs("div",{className:"delete-modal px-6 py-8 relative font-poppins",children:[e.jsx("h1",{className:"font-bold text-3xl text-center",children:"Are you sure ?"}),e.jsx("p",{className:"text-center pt-8",children:"All the images associated with this album will be deleted."}),e.jsx("div",{className:"absolute -top-8 -right-8 text-white cursor-pointer",children:e.jsx(b,{strokeWidth:1.5,size:38,onClick:m})}),e.jsxs("div",{className:"flex justify-center gap-2 pt-6",children:[e.jsx("button",{className:"bg-red-500 text-white px-4 py-3 font-semibold rounded",onClick:m,children:"Cancel"}),e.jsx("button",{className:"bg-blue-500 text-white px-4 py-3 font-semibold rounded",onClick:G,children:"Confirm"})]})]})})]})}export{pe as default};
