import{G as X,r as n,j as e,A as P,S as Z}from"./app-eKKndjnY.js";import{A as ee}from"./AuthenticatedLayout-jI0e412N.js";import{R as se}from"./quill.snow-DvfRwwdB.js";import{I as c}from"./InputLabel-75kjOZUe.js";import{I as o}from"./InputError-B7yvwPX_.js";import{T as f}from"./TextInput-Cqw5La3c.js";import{C as g}from"./Card-KX3b9q5b.js";import{B as v}from"./Badge-BLvQx9Gj.js";import{P as N}from"./PrimaryButton--6srqFl9.js";import{S as I}from"./SecondaryButton-CRWBXrnU.js";import{C as te,o as ae,L as le,M as re,N as ie,O as ce,q as oe,P as T,Q as ne,R as de,S as me}from"./index-TDrpVwW6.js";import{F as xe}from"./material_blue-ixBcrhFU.js";import{$ as d}from"./tabs-C1siPXLW.js";import"./index-XA5Fpi3v.js";import"./index-BarBPuyi.js";import"./index-DvKDCjWq.js";import"./index-Be1TB9th.js";import"./iconBase-Dljp4mII.js";import"./Dropdown-D_xPmhC-.js";import"./transition-BNarjejl.js";import"./index-DOdrVWTX.js";import"./keyboard-VLzb7i-w.js";function Ae({auth:q,categories:j,tags:y,csrf_token:D}){const{data:t,setData:l,post:L,processing:A,errors:i,reset:ue}=X({title:"",content:"",slug:"",categories:[],tags:[],featureImage:null,status:"draft",excerpt:"",meta_title:"",meta_description:"",seo_keywords:"",is_featured:!1,allow_comments:!0,published_at:new Date}),[p,B]=n.useState(""),w=n.useRef(null),[k,M]=n.useState(""),[R,$]=n.useState(0),[O,S]=n.useState(!1),[b,C]=n.useState(!1),G={toolbar:[[{header:[1,2,3,4,5,6,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["blockquote","code-block"],[{align:[]}],["link","image"],[{color:[]},{background:[]}],["clean"]],clipboard:{matchVisual:!1}},H=["header","bold","italic","underline","strike","list","bullet","blockquote","code-block","link","image","align","color","background"],Q=()=>{const s=document.createElement("input");s.setAttribute("type","file"),s.setAttribute("accept","image/*"),s.click(),s.onchange=async()=>{const a=s.files[0],r=new FormData;r.append("image",a),r.append("_token",D);try{const u=await(await fetch(route("admin.blogs.tempImg"),{method:"POST",body:r})).json();if(u.success){const h=_.current.getEditor(),E=h.getSelection(!0);h.insertEmbed(E.index,"image",u.file.url),h.setSelection(E.index+1)}}catch(x){console.error("Error uploading image:",x),alert("Failed to upload image. Please try again.")}}};n.useEffect(()=>{if(typeof window<"u"){const s=document.querySelector(".ql-editor");if(s){const a=s.parentElement.querySelector(".ql-toolbar");if(a){const r=a.querySelector(".ql-image");r&&r.addEventListener("click",x=>{x.preventDefault(),Q()})}}}},[]);const _=n.useRef(null),J=s=>{const a=s.target.value;if(l("title",a),!t.slug||t.slug===t.title.toLowerCase().replace(/[^\w\s]/gi,"").replace(/\s+/g,"-")){const r=a.toLowerCase().replace(/[^\w\s]/gi,"").replace(/\s+/g,"-");l("slug",r)}t.meta_title||l("meta_title",a)},U=s=>{if(!s)return"";const a=document.createElement("div");return a.innerHTML=s,a.textContent||a.innerText||""},z=s=>{if(l("content",s),!t.excerpt){const a=U(s);if(a){const r=a.substring(0,250);l("excerpt",r),t.meta_description||l("meta_description",r)}}};n.useEffect(()=>{t.status==="scheduled"?S(!0):S(!1)},[t.status]);const K=async s=>{s.preventDefault(),L(route("admin.blogs.store"))},F=(s,a)=>{const{value:r,checked:x}=a.target;if(x){const u=t[s];l(s,[...u,r])}else{const u=t[s].filter(h=>h!==r);l(s,u)}},V=s=>{w.current.click()},Y=s=>{const a=URL.createObjectURL(s.target.files[0]);l("featureImage",s.target.files[0]),M(s.target.files[0].name),B(a)},W=s=>{l("published_at",s[0])},m={base:"py-2.5 px-4 rounded-lg text-sm font-medium transition-all duration-200 focus:outline-none",selected:"bg-primary text-white shadow",notSelected:"text-gray-500 hover:bg-gray-100 hover:text-gray-700"};return e.jsxs(ee,{user:q.user,header:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Create New Blog Post"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{onClick:()=>P.visit(route("admin.blogs.index")),children:[e.jsx(te,{className:"mr-2"})," Back"]}),e.jsxs(N,{onClick:()=>C(!b),children:[e.jsx(ae,{className:"mr-2"})," ",b?"Edit":"Preview"]})]})]}),children:[e.jsx(Z,{title:"Add New Blog"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:b?e.jsxs("div",{className:"space-y-8",children:[e.jsxs(g,{className:"relative",children:[e.jsx("div",{className:"absolute top-4 right-4",children:e.jsx(v,{color:"primary",variant:"soft",children:"Preview Mode"})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4",children:t.title||"Post Title"}),p?e.jsx("div",{className:"w-full h-72 overflow-hidden rounded-lg mb-6",children:e.jsx("img",{src:p,alt:t.title,className:"w-full h-full object-cover"})}):e.jsx("div",{className:"w-full h-72 bg-gray-200 rounded-lg mb-6 flex items-center justify-center",children:e.jsx(T,{className:"text-gray-400 h-12 w-12"})}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-6",children:[t.categories.length>0&&j.filter(s=>t.categories.includes(s.id.toString())).map(s=>e.jsx(v,{color:"primary",variant:"soft",children:s.title},s.id)),t.tags.length>0&&y.filter(s=>t.tags.includes(s.id.toString())).map(s=>e.jsx(v,{color:"secondary",variant:"light",children:s.title},s.id))]})]}),e.jsx("div",{className:"prose max-w-none",children:e.jsx("div",{dangerouslySetInnerHTML:{__html:t.content||"<p>Start writing your blog content...</p>"}})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(N,{onClick:()=>C(!1),children:"Return to Editor"})})]}):e.jsx("div",{className:"bg-white shadow-sm sm:rounded-lg",children:e.jsxs("form",{onSubmit:K,children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 p-6",children:[e.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[e.jsxs(g,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(c,{htmlFor:"title",value:"Title"}),e.jsx(f,{id:"title",className:"mt-1 block w-full text-xl",value:t.title,onChange:J,placeholder:"Enter blog title",autoFocus:!0}),e.jsx(o,{message:i.title,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(c,{htmlFor:"slug",value:"Slug"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("span",{className:"text-gray-500 bg-gray-100 px-3 py-2 rounded-l-md border border-r-0 border-gray-300",children:e.jsx(le,{className:"h-4 w-4"})}),e.jsx(f,{id:"slug",className:"rounded-l-none block w-full",value:t.slug,onChange:s=>l("slug",s.target.value),placeholder:"enter-post-slug"})]}),e.jsx(o,{message:i.slug,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(c,{value:"Content"}),e.jsx("div",{className:"mt-1 quill-container border rounded-md",children:e.jsx(se,{ref:_,theme:"snow",value:t.content,onChange:z,modules:G,formats:H,placeholder:"Start writing your blog here...",className:"h-80"})}),e.jsx("style",{jsx:!0,children:`
                                                    .quill-container {
                                                        height: 400px;
                                                    }
                                                    
                                                    .quill-container .ql-container {
                                                        height: 330px;
                                                        font-size: 16px;
                                                        overflow-y: auto;
                                                    }
                                                `}),e.jsx(o,{message:i.content,className:"mt-2"})]})]}),e.jsx(g,{children:e.jsxs(d.Group,{selectedIndex:R,onChange:$,children:[e.jsxs(d.List,{className:"flex space-x-2 mb-4 border-b pb-1",children:[e.jsx(d,{className:({selected:s})=>`${m.base} ${s?m.selected:m.notSelected}`,children:"Excerpt & Settings"}),e.jsxs(d,{className:({selected:s})=>`${m.base} ${s?m.selected:m.notSelected}`,children:[e.jsx(re,{className:"inline mr-1"})," SEO"]})]}),e.jsxs(d.Panels,{children:[e.jsx(d.Panel,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"excerpt",value:"Excerpt"}),e.jsx("textarea",{id:"excerpt",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50",value:t.excerpt,onChange:s=>l("excerpt",s.target.value),placeholder:"A brief summary of your post",rows:3}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Displayed on blog listing pages. If empty, it will be generated from content."}),e.jsx(o,{message:i.excerpt,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-3 md:space-y-0 md:space-x-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"is_featured",type:"checkbox",className:"rounded border-gray-300 text-primary shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50",checked:t.is_featured,onChange:s=>l("is_featured",s.target.checked)}),e.jsxs("label",{htmlFor:"is_featured",className:"ml-2 text-sm text-gray-700 flex items-center",children:[e.jsx(ie,{className:"text-yellow-500 mr-1"})," Feature this post"]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"allow_comments",type:"checkbox",className:"rounded border-gray-300 text-primary shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50",checked:t.allow_comments,onChange:s=>l("allow_comments",s.target.checked)}),e.jsxs("label",{htmlFor:"allow_comments",className:"ml-2 text-sm text-gray-700 flex items-center",children:[e.jsx(ce,{className:"text-gray-500 mr-1"})," Allow comments"]})]})]})]})}),e.jsx(d.Panel,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"meta_title",value:"Meta Title"}),e.jsx(f,{id:"meta_title",className:"mt-1 block w-full",value:t.meta_title,onChange:s=>l("meta_title",s.target.value),placeholder:"SEO Title (defaults to post title)"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[t.meta_title.length," / 60 characters"]}),e.jsx(o,{message:i.meta_title,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"meta_description",value:"Meta Description"}),e.jsx("textarea",{id:"meta_description",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50",value:t.meta_description,onChange:s=>l("meta_description",s.target.value),placeholder:"SEO Description (defaults to excerpt)",rows:3}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[t.meta_description.length," / 160 characters"]}),e.jsx(o,{message:i.meta_description,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"seo_keywords",value:"SEO Keywords"}),e.jsx(f,{id:"seo_keywords",className:"mt-1 block w-full",value:t.seo_keywords,onChange:s=>l("seo_keywords",s.target.value),placeholder:"keyword1, keyword2, keyword3"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Comma-separated keywords for search engines"}),e.jsx(o,{message:i.seo_keywords,className:"mt-2"})]})]})})]})]})})]}),e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs(g,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(c,{value:"Publication Status"}),e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"draft",name:"status",type:"radio",className:"h-4 w-4 text-primary focus:ring-primary border-gray-300",value:"draft",checked:t.status==="draft",onChange:s=>l("status",s.target.value)}),e.jsx("label",{htmlFor:"draft",className:"ml-3 block text-sm font-medium text-gray-700",children:"Draft"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"publish",name:"status",type:"radio",className:"h-4 w-4 text-primary focus:ring-primary border-gray-300",value:"published",checked:t.status==="published",onChange:s=>l("status",s.target.value)}),e.jsx("label",{htmlFor:"publish",className:"ml-3 block text-sm font-medium text-gray-700",children:"Publish immediately"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"schedule",name:"status",type:"radio",className:"h-4 w-4 text-primary focus:ring-primary border-gray-300",value:"scheduled",checked:t.status==="scheduled",onChange:s=>l("status",s.target.value)}),e.jsx("label",{htmlFor:"schedule",className:"ml-3 block text-sm font-medium text-gray-700",children:"Schedule for later"})]}),O&&e.jsx("div",{className:"ml-7 mt-2",children:e.jsxs("div",{className:"flex items-center border rounded-md overflow-hidden",children:[e.jsx("div",{className:"bg-gray-100 p-2 text-gray-500",children:e.jsx(oe,{})}),e.jsx(xe,{value:t.published_at,onChange:W,options:{enableTime:!0,dateFormat:"Y-m-d H:i",minDate:"today"},className:"w-full border-0 focus:ring-0 focus:outline-none p-2"})]})})]}),e.jsx(o,{message:i.status,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(c,{value:"Featured Image"}),e.jsxs("div",{className:"mt-2 border-2 border-dashed rounded-md p-4 text-center cursor-pointer hover:bg-gray-50 transition-colors",onClick:V,children:[p?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:p,alt:"Preview",className:"w-full h-auto rounded-md"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-40 opacity-0 hover:opacity-100 transition-opacity",children:e.jsx("span",{className:"text-white text-sm font-medium px-2 py-1 rounded bg-black bg-opacity-75",children:"Change Image"})})]}):e.jsxs("div",{className:"py-4",children:[e.jsx(T,{className:"mx-auto h-12 w-12 text-gray-300"}),e.jsx("div",{className:"mt-2 text-sm text-gray-600",children:"Click to upload an image"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"PNG, JPG, JPEG up to 5MB"})]}),e.jsx("input",{ref:w,type:"file",className:"hidden",onChange:Y,accept:"image/png, image/jpeg, image/jpg"})]}),k&&e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Selected: ",k]}),e.jsx(o,{message:i.featureImage,className:"mt-2"})]})]}),e.jsxs(g,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ne,{className:"text-gray-400 mr-2"}),e.jsx(c,{value:"Categories",className:"mb-0"})]}),e.jsxs("div",{className:"mt-2 max-h-52 overflow-y-auto border rounded-md p-3",children:[j.map(s=>e.jsxs("div",{className:"flex items-start mb-2",children:[e.jsx("input",{type:"checkbox",id:`category-${s.id}`,value:s.id,className:"mt-1 rounded border-gray-300 text-primary focus:ring-primary",onChange:a=>F("categories",a),checked:t.categories.includes(s.id.toString())}),e.jsx("label",{htmlFor:`category-${s.id}`,className:"ml-2 text-sm text-gray-700",children:s.title})]},s.id)),j.length===0&&e.jsx("p",{className:"text-sm text-gray-500",children:"No categories found"})]}),e.jsx(o,{message:i.categories,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(de,{className:"text-gray-400 mr-2"}),e.jsx(c,{value:"Tags",className:"mb-0"})]}),e.jsxs("div",{className:"mt-2 max-h-52 overflow-y-auto border rounded-md p-3",children:[y.map(s=>e.jsxs("div",{className:"flex items-start mb-2",children:[e.jsx("input",{type:"checkbox",id:`tag-${s.id}`,value:s.id,className:"mt-1 rounded border-gray-300 text-primary focus:ring-primary",onChange:a=>F("tags",a),checked:t.tags.includes(s.id.toString())}),e.jsx("label",{htmlFor:`tag-${s.id}`,className:"ml-2 text-sm text-gray-700",children:s.title})]},s.id)),y.length===0&&e.jsx("p",{className:"text-sm text-gray-500",children:"No tags found"})]}),e.jsx(o,{message:i.tags,className:"mt-2"})]})]})]})]}),e.jsxs("div",{className:"py-4 px-6 border-t bg-gray-50 flex justify-end space-x-2",children:[e.jsx(I,{type:"button",onClick:()=>P.visit(route("admin.blogs.index")),children:"Cancel"}),e.jsxs(N,{type:"submit",processing:A,className:"gap-1",children:[e.jsx(me,{})," Save ",t.status==="draft"?"Draft":t.status==="scheduled"?"Schedule":"Publish"]})]})]})})})})]})}export{Ae as default};
