import{r,j as e,A as S}from"./app-DcU-pHgi.js";import{r as s}from"./index-D3gu5DKJ.js";import{f as C}from"./index-Dw_W2KWe.js";import"./index-BarBPuyi.js";import"./index-x9q-pVUo.js";function D({eventId:g,attendance:n,open:f,handleOpen:_,onSuccess:v}){const[a,h]=r.useState({name:n.name||"",email:n.email||"",phone:n.phone||"",locale:n.locale||"",attendee_type:n.attendee_type||"guest",attendance_mode:n.attendance_mode||"in-person",notes:n.notes||"",check_in_time:n.check_in_time||null}),[t,c]=r.useState({}),[p,x]=r.useState(!1),[d,y]=r.useState(!1);r.useEffect(()=>{h({name:n.name||"",email:n.email||"",phone:n.phone||"",locale:n.locale||"",attendee_type:n.attendee_type||"guest",attendance_mode:n.attendance_mode||"in-person",notes:n.notes||"",check_in_time:n.check_in_time||null})},[n]);const i=l=>{const{name:o,value:m,type:u,checked:N}=l.target;h({...a,[o]:u==="checkbox"?N:m}),t[o]&&c({...t,[o]:null})},j=(l,o)=>{h({...a,[l]:o}),t[l]&&c({...t,[l]:null})},k=()=>{const l={};return a.name.trim()||(l.name="Name is required"),a.email&&!/\S+@\S+\.\S+/.test(a.email)&&(l.email="Email format is invalid"),a.phone&&!/^\+?[0-9\s-()]+$/.test(a.phone)&&(l.phone="Phone format is invalid"),c(l),Object.keys(l).length===0},b=l=>{if(l.preventDefault(),!k())return;x(!0);let o={...a};d&&(o.check_in_time=o.check_in_time?null:new Date().toISOString()),S.put(route("admin.events.update-attendance",{event_id:g,attendance_id:n.id}),o,{onSuccess:m=>{x(!1);const u={...n,name:a.name,email:a.email,phone:a.phone,locale:a.locale,attendee_type:a.attendee_type,attendance_mode:a.attendance_mode,notes:a.notes,check_in_time:d?n.check_in_time?null:new Date().toISOString():n.check_in_time,updated_at:new Date().toISOString()};v(u)},onError:m=>{x(!1),c(m)}})};return e.jsx(s.Dialog,{size:"md",open:f,handler:_,className:"bg-transparent shadow-none",children:e.jsx("form",{onSubmit:b,children:e.jsxs(s.Card,{className:"mx-auto w-full",children:[e.jsxs(s.CardBody,{className:"flex flex-col gap-4",children:[e.jsx(s.Typography,{variant:"h5",color:"blue-gray",className:"mb-2",children:"Edit Attendance Record"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-1 md:col-span-2",children:[e.jsx(s.Input,{type:"text",name:"name",label:"Full Name *",value:a.name,onChange:i,error:!!t.name}),t.name&&e.jsx("span",{className:"text-red-500 text-xs",children:t.name})]}),e.jsxs("div",{children:[e.jsx(s.Input,{type:"email",name:"email",label:"Email Address",value:a.email,onChange:i,error:!!t.email}),t.email&&e.jsx("span",{className:"text-red-500 text-xs",children:t.email})]}),e.jsxs("div",{children:[e.jsx(s.Input,{type:"tel",name:"phone",label:"Phone Number",value:a.phone,onChange:i,error:!!t.phone}),t.phone&&e.jsx("span",{className:"text-red-500 text-xs",children:t.phone})]}),e.jsxs("div",{children:[e.jsx(s.Input,{type:"text",name:"locale",label:"Locale/Region",value:a.locale,onChange:i,error:!!t.locale}),t.locale&&e.jsx("span",{className:"text-red-500 text-xs",children:t.locale})]}),e.jsxs("div",{children:[e.jsxs(s.Select,{label:"Attendee Type",name:"attendee_type",value:a.attendee_type,onChange:l=>j("attendee_type",l),error:!!t.attendee_type,children:[e.jsx(s.Option,{value:"member",children:"Member"}),e.jsx(s.Option,{value:"guest",children:"Guest"})]}),t.attendee_type&&e.jsx("span",{className:"text-red-500 text-xs",children:t.attendee_type})]}),e.jsxs("div",{children:[e.jsxs(s.Select,{label:"Attendance Mode",name:"attendance_mode",value:a.attendance_mode,onChange:l=>j("attendance_mode",l),error:!!t.attendance_mode,children:[e.jsx(s.Option,{value:"in-person",children:"In-Person"}),e.jsx(s.Option,{value:"online",children:"Online"})]}),t.attendance_mode&&e.jsx("span",{className:"text-red-500 text-xs",children:t.attendance_mode})]}),e.jsxs("div",{className:"col-span-1 md:col-span-2",children:[e.jsx(s.Textarea,{name:"notes",label:"Notes",value:a.notes,onChange:i,error:!!t.notes}),t.notes&&e.jsx("span",{className:"text-red-500 text-xs",children:t.notes})]}),a.attendance_mode==="in-person"&&e.jsxs("div",{className:"col-span-1 md:col-span-2 flex items-center gap-2",children:[e.jsx(s.Checkbox,{id:"check-in-toggle",checked:d,onChange:()=>y(!d)}),e.jsx("label",{htmlFor:"check-in-toggle",className:"text-sm",children:n.check_in_time?`Remove check-in (currently checked in at ${C(new Date(n.check_in_time),"MMM d, h:mm a")})`:"Mark as checked in"})]})]})]}),e.jsxs(s.CardFooter,{className:"pt-0 flex justify-end gap-2",children:[e.jsx(s.Button,{variant:"text",color:"red",onClick:_,disabled:p,children:"Cancel"}),e.jsx(s.Button,{type:"submit",disabled:p,children:p?"Saving...":"Update Attendance"})]})]})})})}export{D as default};
