import{G as Z,r as d,j as e,A as I,S as ee}from"./app-eKKndjnY.js";import{A as se}from"./AuthenticatedLayout-jI0e412N.js";import{R as te}from"./quill.snow-DvfRwwdB.js";import{I as o}from"./InputLabel-75kjOZUe.js";import{I as n}from"./InputError-B7yvwPX_.js";import{T as j}from"./TextInput-Cqw5La3c.js";import{C as p}from"./Card-KX3b9q5b.js";import{B as N}from"./Badge-BLvQx9Gj.js";import{P as w}from"./PrimaryButton--6srqFl9.js";import{S as T}from"./SecondaryButton-CRWBXrnU.js";import{C as ae,o as le,L as re,M as ie,N as ce,O as oe,q as ne,P as q,Q as de,R as me,S as xe}from"./index-TDrpVwW6.js";import{F as ue}from"./material_blue-ixBcrhFU.js";import{$ as m}from"./tabs-C1siPXLW.js";import"./index-XA5Fpi3v.js";import"./index-BarBPuyi.js";import"./index-DvKDCjWq.js";import"./index-Be1TB9th.js";import"./iconBase-Dljp4mII.js";import"./Dropdown-D_xPmhC-.js";import"./transition-BNarjejl.js";import"./index-DOdrVWTX.js";import"./keyboard-VLzb7i-w.js";function Be({auth:D,item:a,categories:y,tags:b,csrf_token:L}){const{data:t,setData:r,post:A,processing:B,errors:c,reset:he}=Z({title:a.title,content:a.content,slug:a.slug,categories:a!=null&&a.categories?a.categories.split(","):[],tags:a!=null&&a.tags?a.tags.split(","):[],featureImage:null,status:a.status,excerpt:a.excerpt||"",meta_title:a.meta_title||"",meta_description:a.meta_description||"",seo_keywords:a.seo_keywords||"",is_featured:a.is_featured||!1,allow_comments:a.allow_comments===void 0?!0:a.allow_comments,published_at:a.published_at?new Date(a.published_at):new Date}),[f,M]=d.useState(a.featured_image),k=d.useRef(null),[_,R]=d.useState(""),[$,O]=d.useState(0),[G,C]=d.useState(a.status==="scheduled"),[v,S]=d.useState(!1),H={toolbar:[[{header:[1,2,3,4,5,6,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["blockquote","code-block"],[{align:[]}],["link","image"],[{color:[]},{background:[]}],["clean"]],clipboard:{matchVisual:!1}},Q=["header","bold","italic","underline","strike","list","bullet","blockquote","code-block","link","image","align","color","background"],U=()=>{const s=document.createElement("input");s.setAttribute("type","file"),s.setAttribute("accept","image/*"),s.click(),s.onchange=async()=>{const l=s.files[0],i=new FormData;i.append("image",l),i.append("_token",L);try{const h=await(await fetch(route("admin.blogs.tempImg"),{method:"POST",body:i})).json();if(h.success){const g=F.current.getEditor(),P=g.getSelection(!0);g.insertEmbed(P.index,"image",h.file.url),g.setSelection(P.index+1)}}catch(u){console.error("Error uploading image:",u),alert("Failed to upload image. Please try again.")}}};d.useEffect(()=>{if(typeof window<"u"){const s=document.querySelector(".ql-editor");if(s){const l=s.parentElement.querySelector(".ql-toolbar");if(l){const i=l.querySelector(".ql-image");i&&i.addEventListener("click",u=>{u.preventDefault(),U()})}}}},[]);const F=d.useRef(null),J=s=>{const l=s.target.value;if(r("title",l),!t.slug||t.slug===t.title.toLowerCase().replace(/[^\w\s]/gi,"").replace(/\s+/g,"-")){const i=l.toLowerCase().replace(/[^\w\s]/gi,"").replace(/\s+/g,"-");r("slug",i)}t.meta_title||r("meta_title",l)},z=s=>{if(!s)return"";const l=document.createElement("div");return l.innerHTML=s,l.textContent||l.innerText||""},K=s=>{if(r("content",s),!t.excerpt){const l=z(s);if(l){const i=l.substring(0,250);r("excerpt",i),t.meta_description||r("meta_description",i)}}};d.useEffect(()=>{t.status==="scheduled"?C(!0):C(!1)},[t.status]);const V=async s=>{s.preventDefault(),A(route("admin.blogs.update",a.id))},E=(s,l)=>{const{value:i,checked:u}=l.target;if(u){const h=t[s];r(s,[...h,i])}else{const h=t[s].filter(g=>g!==i);r(s,h)}},Y=s=>{k.current.click()},W=s=>{const l=URL.createObjectURL(s.target.files[0]);r("featureImage",s.target.files[0]),R(s.target.files[0].name),M(l)},X=s=>{r("published_at",s[0])},x={base:"py-2.5 px-4 rounded-lg text-sm font-medium transition-all duration-200 focus:outline-none",selected:"bg-primary text-white shadow",notSelected:"text-gray-500 hover:bg-gray-100 hover:text-gray-700"};return e.jsxs(se,{user:D.user,header:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Edit Blog Post"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(T,{onClick:()=>I.visit(route("admin.blogs.index")),children:[e.jsx(ae,{className:"mr-2"})," Back"]}),e.jsxs(w,{onClick:()=>S(!v),children:[e.jsx(le,{className:"mr-2"})," ",v?"Edit":"Preview"]})]})]}),children:[e.jsx(ee,{title:"Edit Blog Post"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:v?e.jsxs("div",{className:"space-y-8",children:[e.jsxs(p,{className:"relative",children:[e.jsx("div",{className:"absolute top-4 right-4",children:e.jsx(N,{color:"primary",variant:"soft",children:"Preview Mode"})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4",children:t.title||"Post Title"}),f?e.jsx("div",{className:"w-full h-72 overflow-hidden rounded-lg mb-6",children:e.jsx("img",{src:f,alt:t.title,className:"w-full h-full object-cover"})}):e.jsx("div",{className:"w-full h-72 bg-gray-200 rounded-lg mb-6 flex items-center justify-center",children:e.jsx(q,{className:"text-gray-400 h-12 w-12"})}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-6",children:[t.categories.length>0&&y.filter(s=>t.categories.includes(s.id.toString())).map(s=>e.jsx(N,{color:"primary",variant:"soft",children:s.title},s.id)),t.tags.length>0&&b.filter(s=>t.tags.includes(s.id.toString())).map(s=>e.jsx(N,{color:"secondary",variant:"light",children:s.title},s.id))]})]}),e.jsx("div",{className:"prose max-w-none",children:e.jsx("div",{dangerouslySetInnerHTML:{__html:t.content||"<p>Start writing your blog content...</p>"}})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(w,{onClick:()=>S(!1),children:"Return to Editor"})})]}):e.jsx("div",{className:"bg-white shadow-sm sm:rounded-lg",children:e.jsxs("form",{onSubmit:V,children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 p-6",children:[e.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[e.jsxs(p,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(o,{htmlFor:"title",value:"Title"}),e.jsx(j,{id:"title",className:"mt-1 block w-full text-xl",value:t.title,onChange:J,placeholder:"Enter blog title",autoFocus:!0}),e.jsx(n,{message:c.title,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(o,{htmlFor:"slug",value:"Slug"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("span",{className:"text-gray-500 bg-gray-100 px-3 py-2 rounded-l-md border border-r-0 border-gray-300",children:e.jsx(re,{className:"h-4 w-4"})}),e.jsx(j,{id:"slug",className:"rounded-l-none block w-full",value:t.slug,onChange:s=>r("slug",s.target.value),placeholder:"enter-post-slug"})]}),e.jsx(n,{message:c.slug,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(o,{value:"Content"}),e.jsx("div",{className:"mt-1 quill-container border rounded-md",children:e.jsx(te,{ref:F,theme:"snow",value:t.content,onChange:K,modules:H,formats:Q,placeholder:"Start writing your blog here...",className:"h-80"})}),e.jsx("style",{jsx:!0,children:`
                                                    .quill-container {
                                                        height: 400px;
                                                    }
                                                    
                                                    .quill-container .ql-container {
                                                        height: 330px;
                                                        font-size: 16px;
                                                        overflow-y: auto;
                                                    }
                                                `}),e.jsx(n,{message:c.content,className:"mt-2"})]})]}),e.jsx(p,{children:e.jsxs(m.Group,{selectedIndex:$,onChange:O,children:[e.jsxs(m.List,{className:"flex space-x-2 mb-4 border-b pb-1",children:[e.jsx(m,{className:({selected:s})=>`${x.base} ${s?x.selected:x.notSelected}`,children:"Excerpt & Settings"}),e.jsxs(m,{className:({selected:s})=>`${x.base} ${s?x.selected:x.notSelected}`,children:[e.jsx(ie,{className:"inline mr-1"})," SEO"]})]}),e.jsxs(m.Panels,{children:[e.jsx(m.Panel,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"excerpt",value:"Excerpt"}),e.jsx("textarea",{id:"excerpt",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50",value:t.excerpt,onChange:s=>r("excerpt",s.target.value),placeholder:"A brief summary of your post",rows:3}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Displayed on blog listing pages. If empty, it will be generated from content."}),e.jsx(n,{message:c.excerpt,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-3 md:space-y-0 md:space-x-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"is_featured",type:"checkbox",className:"rounded border-gray-300 text-primary shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50",checked:t.is_featured,onChange:s=>r("is_featured",s.target.checked)}),e.jsxs("label",{htmlFor:"is_featured",className:"ml-2 text-sm text-gray-700 flex items-center",children:[e.jsx(ce,{className:"text-yellow-500 mr-1"})," Feature this post"]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"allow_comments",type:"checkbox",className:"rounded border-gray-300 text-primary shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50",checked:t.allow_comments,onChange:s=>r("allow_comments",s.target.checked)}),e.jsxs("label",{htmlFor:"allow_comments",className:"ml-2 text-sm text-gray-700 flex items-center",children:[e.jsx(oe,{className:"text-gray-500 mr-1"})," Allow comments"]})]})]})]})}),e.jsx(m.Panel,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"meta_title",value:"Meta Title"}),e.jsx(j,{id:"meta_title",className:"mt-1 block w-full",value:t.meta_title,onChange:s=>r("meta_title",s.target.value),placeholder:"SEO Title (defaults to post title)"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[t.meta_title.length," / 60 characters"]}),e.jsx(n,{message:c.meta_title,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"meta_description",value:"Meta Description"}),e.jsx("textarea",{id:"meta_description",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50",value:t.meta_description,onChange:s=>r("meta_description",s.target.value),placeholder:"SEO Description (defaults to excerpt)",rows:3}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[t.meta_description.length," / 160 characters"]}),e.jsx(n,{message:c.meta_description,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"seo_keywords",value:"SEO Keywords"}),e.jsx(j,{id:"seo_keywords",className:"mt-1 block w-full",value:t.seo_keywords,onChange:s=>r("seo_keywords",s.target.value),placeholder:"keyword1, keyword2, keyword3"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Comma-separated keywords for search engines"}),e.jsx(n,{message:c.seo_keywords,className:"mt-2"})]})]})})]})]})})]}),e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs(p,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(o,{value:"Publication Status"}),e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"draft",name:"status",type:"radio",className:"h-4 w-4 text-primary focus:ring-primary border-gray-300",value:"draft",checked:t.status==="draft",onChange:s=>r("status",s.target.value)}),e.jsx("label",{htmlFor:"draft",className:"ml-3 block text-sm font-medium text-gray-700",children:"Draft"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"publish",name:"status",type:"radio",className:"h-4 w-4 text-primary focus:ring-primary border-gray-300",value:"published",checked:t.status==="published",onChange:s=>r("status",s.target.value)}),e.jsx("label",{htmlFor:"publish",className:"ml-3 block text-sm font-medium text-gray-700",children:"Publish immediately"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"schedule",name:"status",type:"radio",className:"h-4 w-4 text-primary focus:ring-primary border-gray-300",value:"scheduled",checked:t.status==="scheduled",onChange:s=>r("status",s.target.value)}),e.jsx("label",{htmlFor:"schedule",className:"ml-3 block text-sm font-medium text-gray-700",children:"Schedule for later"})]}),G&&e.jsx("div",{className:"ml-7 mt-2",children:e.jsxs("div",{className:"flex items-center border rounded-md overflow-hidden",children:[e.jsx("div",{className:"bg-gray-100 p-2 text-gray-500",children:e.jsx(ne,{})}),e.jsx(ue,{value:t.published_at,onChange:X,options:{enableTime:!0,dateFormat:"Y-m-d H:i",minDate:"today"},className:"w-full border-0 focus:ring-0 focus:outline-none p-2"})]})})]}),e.jsx(n,{message:c.status,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(o,{value:"Featured Image"}),e.jsxs("div",{className:"mt-2 border-2 border-dashed rounded-md p-4 text-center cursor-pointer hover:bg-gray-50 transition-colors",onClick:Y,children:[f?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:f,alt:"Preview",className:"w-full h-auto rounded-md"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-40 opacity-0 hover:opacity-100 transition-opacity",children:e.jsx("span",{className:"text-white text-sm font-medium px-2 py-1 rounded bg-black bg-opacity-75",children:"Change Image"})})]}):e.jsxs("div",{className:"py-4",children:[e.jsx(q,{className:"mx-auto h-12 w-12 text-gray-300"}),e.jsx("div",{className:"mt-2 text-sm text-gray-600",children:"Click to upload an image"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"PNG, JPG, JPEG up to 5MB"})]}),e.jsx("input",{ref:k,type:"file",className:"hidden",onChange:W,accept:"image/png, image/jpeg, image/jpg"})]}),_&&e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Selected: ",_]}),e.jsx(n,{message:c.featureImage,className:"mt-2"})]})]}),e.jsxs(p,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(de,{className:"text-gray-400 mr-2"}),e.jsx(o,{value:"Categories",className:"mb-0"})]}),e.jsxs("div",{className:"mt-2 max-h-52 overflow-y-auto border rounded-md p-3",children:[y.map(s=>e.jsxs("div",{className:"flex items-start mb-2",children:[e.jsx("input",{type:"checkbox",id:`category-${s.id}`,value:s.id,className:"mt-1 rounded border-gray-300 text-primary focus:ring-primary",onChange:l=>E("categories",l),checked:t.categories.includes(s.id.toString())}),e.jsx("label",{htmlFor:`category-${s.id}`,className:"ml-2 text-sm text-gray-700",children:s.title})]},s.id)),y.length===0&&e.jsx("p",{className:"text-sm text-gray-500",children:"No categories found"})]}),e.jsx(n,{message:c.categories,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(me,{className:"text-gray-400 mr-2"}),e.jsx(o,{value:"Tags",className:"mb-0"})]}),e.jsxs("div",{className:"mt-2 max-h-52 overflow-y-auto border rounded-md p-3",children:[b.map(s=>e.jsxs("div",{className:"flex items-start mb-2",children:[e.jsx("input",{type:"checkbox",id:`tag-${s.id}`,value:s.id,className:"mt-1 rounded border-gray-300 text-primary focus:ring-primary",onChange:l=>E("tags",l),checked:t.tags.includes(s.id.toString())}),e.jsx("label",{htmlFor:`tag-${s.id}`,className:"ml-2 text-sm text-gray-700",children:s.title})]},s.id)),b.length===0&&e.jsx("p",{className:"text-sm text-gray-500",children:"No tags found"})]}),e.jsx(n,{message:c.tags,className:"mt-2"})]})]})]})]}),e.jsxs("div",{className:"py-4 px-6 border-t bg-gray-50 flex justify-end space-x-2",children:[e.jsx(T,{type:"button",onClick:()=>I.visit(route("admin.blogs.index")),children:"Cancel"}),e.jsxs(w,{type:"submit",processing:B,className:"gap-1",children:[e.jsx(xe,{})," Update"]})]})]})})})})]})}export{Be as default};
