import{r as i,j as e,A as y,S as X,x as A}from"./app-DcU-pHgi.js";import{A as Z}from"./AuthenticatedLayout-YxBYr9wt.js";import{D as ee}from"./datetime-DcQSltNB.js";import{P as se}from"./PrimaryButton-Bu9WmYf4.js";import{S as $}from"./SecondaryButton-BoPBhd-Z.js";import{D as B}from"./DangerButton-DSEupD0-.js";import{M as te}from"./Modal-DBDAEaT5.js";import{B as u}from"./Badge-BGYZeVxZ.js";import{C as N}from"./Card-BhSBht7v.js";import{j as ae,P as re,o as M,Q as le,m as k,k as ie,r as ce,F as w,a as v,v as ne,R as de,S as oe,T as xe,q as me}from"./index-VRqsH7Np.js";import{T as he}from"./TextInput-DVTwl0cB.js";import{r as h}from"./index-D3gu5DKJ.js";import{$ as d}from"./tabs-CFhvmSYm.js";import"./index-Di9WJGrQ.js";import"./iconBase-8fZdkZtg.js";import"./Dropdown-BEzsTaq8.js";import"./transition-C-BcvKEz.js";import"./index-C6XVj9fJ.js";import"./keyboard-BcSRVZMa.js";import"./index-BarBPuyi.js";import"./index-x9q-pVUo.js";function Me({auth:L,posts:b,categories:E,tags:I,stats:p}){const[R,g]=i.useState(!1),[T,U]=i.useState(null),[j,z]=i.useState(!1),[f,O]=i.useState(""),[P,Q]=i.useState(b),[m,q]=i.useState(0),[n,V]=i.useState("all"),[c,_]=i.useState("newest"),[o,S]=i.useState("desc"),[D,W]=i.useState(!1),[a,G]=i.useState({title:!0,status:!0,author:!0,category:!0,date:!0,actions:!0});i.useEffect(()=>{let s=[...b];if(m===1?s=s.filter(t=>t.status==="published"):m===2?s=s.filter(t=>t.status==="draft"):m===3?s=s.filter(t=>t.status==="scheduled"):m===4&&(s=s.filter(t=>t.deleted_at!==null)),f){const t=f.toLowerCase();s=s.filter(r=>r.title.toLowerCase().includes(t)||r.author&&r.author.name&&r.author.name.toLowerCase().includes(t))}if(n!=="all"){if(n==="featured")s=s.filter(t=>t.is_featured);else if(n==="with_comments")s=s.filter(t=>t.allow_comments);else if(n==="no_comments")s=s.filter(t=>!t.allow_comments);else if(n.startsWith("category_")){const t=n.replace("category_","");s=s.filter(r=>r.categories&&r.categories.includes(t))}else if(n.startsWith("tag_")){const t=n.replace("tag_","");s=s.filter(r=>r.tags&&r.tags.includes(t))}}s.sort((t,r)=>{let x=0;return c==="title"?x=t.title.localeCompare(r.title):c==="newest"?x=new Date(r.created_at)-new Date(t.created_at):c==="updated"?x=new Date(r.updated_at)-new Date(t.updated_at):c==="views"?x=(r.views||0)-(t.views||0):c==="status"&&(x=t.status.localeCompare(r.status)),o==="asc"?x:-x}),Q(s)},[b,f,m,n,c,o]);const F=(s,t=!1)=>{U(s),z(t),g(!0)},H=()=>{j?y.delete(route("admin.blogs.force.delete",T.id)):y.delete(route("admin.blogs.delete",T.id)),g(!1)},Y=s=>{y.post(route("admin.blogs.restore",s.id))},l={base:"px-4 py-2.5 text-sm font-medium border-b-2 border-transparent focus:outline-none",selected:"text-primary border-primary",notSelected:"text-gray-500 hover:text-gray-700 hover:border-gray-300"},J=s=>{if(!s)return"";const t=s.replace(/<[^>]+>/g,"");return t.length>100?t.substring(0,100)+"...":t},K=(s,t,r)=>{if(t)return e.jsx(u,{color:"danger",variant:"soft",children:"Trashed"});switch(s){case"published":return e.jsx(u,{color:"success",variant:"solid",children:"Published"});case"draft":return e.jsx(u,{color:"gray",variant:"soft",children:"Draft"});case"scheduled":return e.jsxs(u,{color:"primary",variant:"soft",className:"flex items-center gap-1",children:[e.jsx(me,{className:"text-xs"}),"Scheduled"]});default:return e.jsx(u,{color:"gray",variant:"soft",children:s})}},C=s=>{c===s?S(o==="asc"?"desc":"asc"):(_(s),S("desc"))};return e.jsxs(Z,{user:L.user,header:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Manage Blog Posts"}),e.jsxs(se,{onClick:()=>y.visit(route("admin.blogs.add")),children:[e.jsx(ae,{className:"mr-2"})," New Post"]})]}),children:[e.jsx(X,{title:"Manage Blog Posts"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(N,{className:"bg-white flex items-center px-4 py-5",children:[e.jsx("div",{className:"flex-shrink-0 p-3 mr-4 bg-blue-100 rounded-full",children:e.jsx(re,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Posts"}),e.jsx("p",{className:"text-3xl font-semibold text-gray-900",children:p.total})]})]}),e.jsxs(N,{className:"bg-white flex items-center px-4 py-5",children:[e.jsx("div",{className:"flex-shrink-0 p-3 mr-4 bg-green-100 rounded-full",children:e.jsx(M,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Published"}),e.jsx("p",{className:"text-3xl font-semibold text-gray-900",children:p.published})]})]}),e.jsxs(N,{className:"bg-white flex items-center px-4 py-5",children:[e.jsx("div",{className:"flex-shrink-0 p-3 mr-4 bg-yellow-100 rounded-full",children:e.jsx(le,{className:"h-6 w-6 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Drafts"}),e.jsx("p",{className:"text-3xl font-semibold text-gray-900",children:p.drafts})]})]}),e.jsxs(N,{className:"bg-white flex items-center px-4 py-5",children:[e.jsx("div",{className:"flex-shrink-0 p-3 mr-4 bg-red-100 rounded-full",children:e.jsx(k,{className:"h-6 w-6 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Trashed"}),e.jsx("p",{className:"text-3xl font-semibold text-gray-900",children:p.trashed})]})]})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-5 sm:px-6 border-b border-gray-200 flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:[e.jsxs("div",{className:"flex-grow md:max-w-md relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(ie,{className:"h-5 w-5 text-gray-400"})}),e.jsx(he,{type:"text",className:"pl-10 pr-4 py-2 w-full",placeholder:"Search posts...",value:f,onChange:s=>O(s.target.value)})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>W(!D),className:"flex items-center gap-1 text-sm text-gray-500 py-2 px-3 rounded-md hover:bg-gray-100",children:[e.jsx(ce,{className:"mr-1"}),"Columns"]}),D&&e.jsxs("div",{className:"absolute right-0 mt-2 w-60 bg-white rounded-md shadow-lg z-20 p-3 border",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Show/Hide Columns"}),Object.keys(a).map(s=>e.jsxs("div",{className:"flex items-center py-1",children:[e.jsx("input",{type:"checkbox",id:`col-${s}`,checked:a[s],onChange:()=>G({...a,[s]:!a[s]}),className:"rounded border-gray-300 text-primary focus:ring-primary"}),e.jsx("label",{htmlFor:`col-${s}`,className:"ml-2 text-sm text-gray-700 capitalize",children:s})]},s))]})]}),e.jsx("div",{className:"relative",children:e.jsxs("select",{className:"rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50 text-sm",value:n,onChange:s=>V(s.target.value),children:[e.jsx("option",{value:"all",children:"All Posts"}),e.jsx("option",{value:"featured",children:"Featured Posts"}),e.jsx("option",{value:"with_comments",children:"Comments Allowed"}),e.jsx("option",{value:"no_comments",children:"Comments Disabled"}),e.jsx("optgroup",{label:"Categories",children:E.map(s=>e.jsx("option",{value:`category_${s.id}`,children:s.title},s.id))}),e.jsx("optgroup",{label:"Tags",children:I.map(s=>e.jsx("option",{value:`tag_${s.id}`,children:s.title},s.id))})]})}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{className:"rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50 text-sm",value:c,onChange:s=>_(s.target.value),children:[e.jsx("option",{value:"newest",children:"Newest First"}),e.jsx("option",{value:"updated",children:"Last Updated"}),e.jsx("option",{value:"title",children:"Title"}),e.jsx("option",{value:"views",children:"Views"}),e.jsx("option",{value:"status",children:"Status"})]}),e.jsx("button",{onClick:()=>S(o==="asc"?"desc":"asc"),className:"ml-1 inline-flex items-center p-1 border border-transparent rounded-full shadow-sm text-white bg-primary hover:bg-primary-dark",children:o==="asc"?e.jsx(w,{className:"h-3 w-3"}):e.jsx(v,{className:"h-3 w-3"})})]})]})]}),e.jsxs(d.Group,{selectedIndex:m,onChange:q,children:[e.jsxs(d.List,{className:"flex border-b border-gray-200",children:[e.jsx(d,{className:({selected:s})=>`${l.base} ${s?l.selected:l.notSelected}`,children:"All Posts"}),e.jsx(d,{className:({selected:s})=>`${l.base} ${s?l.selected:l.notSelected}`,children:"Published"}),e.jsx(d,{className:({selected:s})=>`${l.base} ${s?l.selected:l.notSelected}`,children:"Drafts"}),e.jsx(d,{className:({selected:s})=>`${l.base} ${s?l.selected:l.notSelected}`,children:"Scheduled"}),e.jsx(d,{className:({selected:s})=>`${l.base} ${s?l.selected:l.notSelected}`,children:"Trash"})]}),e.jsx(d.Panels,{children:[0,1,2,3,4].map(s=>e.jsx(d.Panel,{className:"px-4 py-5 sm:p-6",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[a.title&&e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>C("title"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Title"}),c==="title"&&(o==="asc"?e.jsx(w,{className:"h-3 w-3"}):e.jsx(v,{className:"h-3 w-3"}))]})}),a.status&&e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>C("status"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Status"}),c==="status"&&(o==="asc"?e.jsx(w,{className:"h-3 w-3"}):e.jsx(v,{className:"h-3 w-3"}))]})}),a.author&&e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Author"}),a.category&&e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),a.date&&e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>C("newest"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Date"}),c==="newest"&&(o==="asc"?e.jsx(w,{className:"h-3 w-3"}):e.jsx(v,{className:"h-3 w-3"}))]})}),a.actions&&e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:P.length>0?P.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[a.title&&e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center",children:[t.featured_image?e.jsx("img",{src:t.featured_image,alt:t.title,className:"h-10 w-10 rounded-md object-cover mr-3"}):e.jsx("div",{className:"h-10 w-10 rounded-md bg-gray-200 mr-3 flex items-center justify-center",children:e.jsx(ne,{className:"text-gray-400"})}),e.jsxs("div",{className:"max-w-lg",children:[e.jsxs("div",{className:"font-medium text-gray-900 flex items-center",children:[t.title,t.is_featured&&e.jsx(h.Tooltip,{content:"Featured Post",children:e.jsx(de,{className:"text-yellow-500 ml-2"})})]}),e.jsx("div",{className:"text-sm text-gray-500 truncate max-w-xs",children:J(t.content)})]})]})}),a.status&&e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:K(t.status,t.deleted_at,t.published_at)}),a.author&&e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:t.author?t.author.name:"Unknown"})}),a.category&&e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:t.category?t.category.name:"Uncategorized"})}),a.date&&e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:ee.fromISO(t.created_at).toFormat("LLL dd, yyyy")}),a.actions&&e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsx("div",{className:"flex items-center justify-end space-x-2",children:t.deleted_at?e.jsxs(e.Fragment,{children:[e.jsx(h.Tooltip,{content:"Restore",children:e.jsx($,{onClick:()=>Y(t),className:"!p-2",children:e.jsx(oe,{className:"h-4 w-4"})})}),e.jsx(h.Tooltip,{content:"Delete Permanently",children:e.jsx(B,{onClick:()=>F(t,!0),className:"!p-2",children:e.jsx(k,{className:"h-4 w-4"})})})]}):e.jsxs(e.Fragment,{children:[e.jsx(h.Tooltip,{content:"View",children:e.jsx(A,{href:route("blogs.show",t.slug),className:"text-gray-400 hover:text-gray-500 p-2",target:"_blank",children:e.jsx(M,{className:"h-4 w-4"})})}),e.jsx(h.Tooltip,{content:"Edit",children:e.jsx(A,{href:route("admin.blogs.edit",t.id),className:"text-primary hover:text-primary-dark p-2",children:e.jsx(xe,{className:"h-4 w-4"})})}),e.jsx(h.Tooltip,{content:"Move to Trash",children:e.jsx("button",{onClick:()=>F(t),className:"text-red-600 hover:text-red-900 p-2",children:e.jsx(k,{className:"h-4 w-4"})})})]})})})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:Object.values(a).filter(Boolean).length,className:"px-6 py-4 text-center text-gray-500",children:"No posts found"})})})]})})},s))})]})]})]})}),e.jsx(te,{show:R,onClose:()=>g(!1),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:j?"Permanently Delete Post":"Move Post to Trash"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:j?"Are you sure you want to permanently delete this post? This action cannot be undone.":"Are you sure you want to move this post to trash? You can restore it later if needed."}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx($,{onClick:()=>g(!1),children:"Cancel"}),e.jsx(B,{onClick:H,children:j?"Delete Permanently":"Move to Trash"})]})]})})]})}export{Me as default};
